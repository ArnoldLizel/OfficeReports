<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Office Performance Rating</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  
</head>
<body class="bg-gradient-to-r from-[#0D1164] to-[#640D5F] min-h-screen p-6 text-white"></body>

  <!-- Office Dropdown -->
  <div class="max-w-lg mx-auto mb-6 bg-white p-4 rounded-lg shadow-md">
    <label for="office-select" class="block mb-2 text-lg font-semibold text-gray-700">Select Office:</label>
    <select id="office-select" onchange="showReport()" class="w-full p-2 rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-400">
      <option value="">-- Select Office --</option>
      <option value="FOIC">FOIC</option>
      <option value="VCOM">VCOM</option>
      <option value="CNS">CNS</option>
      <option value="N1">N1</option>
      <option value="N2">N2</option>
      <option value="N3">N3</option>
      <option value="N4">N4</option>
      <option value="N5">N5</option>
      <option value="N6">N6</option>
      <option value="N7">N7</option>
      <option value="N8">N8</option>
      <option value="N9">N9</option>
      <option value="N10">N10</option>
      <option value="N11">N11</option>
      <option value="NIOFC">NIOFC</option>
      <option value="CMCPO">CMCPO</option>
      <option value="CRDO">CRDO</option>
      <option value="CNLE">CNLE</option>
      <option value="NSPAO">NSPAO</option>
      <option value="NPAO">NPAO</option>
      <option value="ONSSSM">ONSSSM</option>
      <option value="NJAG">NJAG</option>
      <option value="TNCH">TNCH</option>
      <option value="TCSN">TCSN</option>
      <option value="TCNN">TCNN</option>
      <option value="TCDSN">TCDSN</option>
      <option value="TNCE">TNCE</option>
      <option value="PNOLOAC">PNOLOAC</option>
      <option value="TNIA">TNIA</option>
      <option value="NSO">NSO</option>
      <option value="TNIG">TNIG</option>
      <option value="OESPA">OESPA</option>
      <option value="TNPM">TNPM</option>
      <option value="OTNA">OTNA</option>
      <option value="PNGADC">PNGADC</option>
      <option value="PNREO">PNREO</option>
      <option value="PNMO">PNMO</option>
      <option value="ONIA">ONIA</option>
      <option value="PNMCMC">PNMCMC</option>
      <option value="HSG">HSG</option>
    </select>
  </div>

  <!-- Add this button above Table 1 -->
<div class="max-w-5xl mx-auto mb-4">
  <button onclick="showSummary()" class="px-4 py-2 bg-blue-500 text-white rounded-lg shadow hover:bg-blue-600">
    Summary
  </button>
</div>

 <!-- ===== TABLE 1: TABLE OF EQUIPMENT REPORT ===== -->
 <div class="max-w-5xl mx-auto bg-white p-4 rounded-lg shadow-lg mb-8">
    <h2 class="text-2xl font-bold mb-4 text-gray-800 border-b pb-2">Equipment Readiness Report</h2>
    <div class="overflow-x-auto">
      <table class="w-full border border-gray-300 border-collapse rounded-lg overflow-hidden">
        <thead class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-center text-sm uppercase tracking-wider">
   
 <tr class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-center text-sm uppercase tracking-wider">
          <th class="border border-black p-2">EQUIPMENT CATEGORY</th>
          <th class="border border-black p-2">TABLE OF EQUIPMENT (TE 2019) (A)</th>
          <th class="border border-black p-2">ACTUAL (B)</th>
          <th class="border border-black p-2">RATING (ACTUAL / TE × 100%)</th>
        </tr>
      </thead>
      <tbody id="toe-body">
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">MOBILITY</td></tr>
        <tr><td class="p-2">GROUND (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">AIR (N11)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">SEA (N11)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">FIREPOWER</td></tr>
        <tr><td class="p-2">INDIVIDUAL (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">CREW-SERVED (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">COMMUNICATION</td></tr>
        <tr><td class="p-2">COMMUNICATION (N6)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-100 font-bold"><td colspan="3" class="p-2">MISSION ESSENTIAL EQUIPMENT (80%)</td><td id="mee1" class="text-center"></td></tr>
        
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">MEDICAL</td></tr>
        <tr><td class="p-2">MEDICAL (N1)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">DENTAL</td></tr>
        <tr><td class="p-2">DENTAL (N1)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">QUARTERMASTER</td></tr>
        <tr><td class="p-2">QUARTERMASTER (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="border-black bg-blue-400 font-bold text-white"><td colspan="3" class="p-2">SECONDARY EQUIPMENT (20%)</td><td id="se1" class="text-center"></td></tr>
        <tr class="border-black bg-purple-400 font-bold text-white"><td colspan="3" class="p-2">MEE (80%) + SE (20%)</td><td id="final1" class="text-center"></td></tr>
        <tr><td colspan="4" class="text-center font-bold p-2" id="redcon1"></td></tr>
      </tbody>
    </table>
  </div>

  <!-- ===== TABLE 2: MAINTENANCE READINESS REPORT ===== -->
  <div class="bg-white p-4 rounded-lg shadow-lg">
    <h2 class="text-xl font-bold mb-4">Maintenance Readiness Report</h2>
    <table class="w-full border border-gray-300 border-collapse rounded-lg overflow-hidden">
      <thead class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-center text-sm uppercase tracking-wider">
        <tr>
          <th class="border border-black p-2">EQUIPMENT CATEGORY</th>
          <th class="border border-black p-2">ON HAND EQUIPMENT (A)</th>
          <th class="border border-black p-2">SERVICEABLE (B)</th>
          <th class="border border-black p-2">RATING (B / A × 100%)</th>
        </tr>
      </thead>
      <tbody id="mrr-body">
        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">MOBILITY</td></tr>
        <tr><td class="p-2">GROUND (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">AIR (N11)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">SEA (N11)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">FIREPOWER</td></tr>
        <tr><td class="p-2">INDIVIDUAL (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
        <tr><td class="p-2">CREW-SERVED (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">COMMUNICATION</td></tr>
        <tr><td class="p-2">COMMUNICATION (N6)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-100 font-bold"><td colspan="3" class="p-2">MISSION ESSENTIAL EQUIPMENT (80%)</td><td id="mee2" class="text-center"></td></tr>
       <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">MEDICAL</td></tr>
        <tr><td class="p-2">MEDICAL (N1)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">DENTAL</tr>
        <tr><td class="p-2">DENTAL (N1)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>
      
      <tr class="bg-gray-200"><td colspan="4" class="border border-black p-2 font-bold text-center">QUARTERMASTER
        <tr><td class="p-2">QUARTER MASTER (N4)</td><td><input type="number" class="w-full p-1 border"></td><td><input type="number" class="w-full p-1 border"></td><td class="rating text-center"></td></tr>

        <tr class="border-black bg-blue-400 font-bold text-white"><td colspan="3" class="p-2">SECONDARY EQUIPMENT (20%)</td><td id="se2" class="text-center"></td></tr>
        <tr class="border-black bg-purple-400 font-bold text-white"><td colspan="3" class="p-2">MEE (80%) + SE (20%)</td><td id="final2" class="text-center"></td></tr>
        <tr><td colspan="4" class="text-center font-bold p-2" id="redcon2"></td></tr>
      </tbody>
    </table>
  </div>

  <script>
  const officeData = {}; // Stores all offices' table data

  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("tbody").forEach((tbody) => {
      tbody.addEventListener("input", (event) => {
        const row = event.target.closest("tr");
        if (!row) return;

        const inputs = row.querySelectorAll("input");
        const ratingCell = row.querySelector(".rating");

        if (inputs.length === 2 && ratingCell) {
          const a = parseFloat(inputs[0].value) || 0;
          const b = parseFloat(inputs[1].value) || 0;
          let rating = a > 0 ? (b / a) * 100 : "";
          if (rating !== "") {
            rating = Math.min(rating, 100).toFixed(2); // Cap at 100
            ratingCell.textContent = rating + "%";
          } else {
            ratingCell.textContent = "";
          }
        }

        // Save current data for the selected office
        const office = document.getElementById("office-select").value;
        if (office) saveOfficeData(office);
      });
    });
  });

  function saveOfficeData(office) {
    const tableData = [];
    document.querySelectorAll("tbody tr").forEach(row => {
      const inputs = row.querySelectorAll("input");
      const rowData = [];
      inputs.forEach(input => rowData.push(input.value));
      tableData.push(rowData);
    });
    officeData[office] = tableData;
  }

  function loadOfficeData(office) {
    if (!officeData[office]) return;
    const rows = document.querySelectorAll("tbody tr");
    officeData[office].forEach((rowData, rowIndex) => {
      const inputs = rows[rowIndex].querySelectorAll("input");
      if (!inputs.length) return;
      rowData.forEach((val, inputIndex) => {
        inputs[inputIndex].value = val;
      });
    });
    // Trigger recalculation after loading
    document.querySelectorAll("tbody").forEach(tbody => {
      tbody.dispatchEvent(new Event("input"));
    });
  }

  function clearTable() {
    document.querySelectorAll("tbody input").forEach(input => input.value = "");
    document.querySelectorAll(".rating").forEach(cell => cell.textContent = "");
  }

  function showReport() {
    const office = document.getElementById("office-select").value;
    clearTable();
    if (officeData[office]) {
      loadOfficeData(office);
    }
  }

  function showSummary() {
  // Clear current table inputs
  clearTable();

  // Check if we have any data
  const officeKeys = Object.keys(officeData);
  if (!officeKeys.length) return;

  // Get row counts for Table 1 and Table 2
  const toeRows = document.querySelectorAll("#toe-body tr").length;
  const mrrRows = document.querySelectorAll("#mrr-body tr").length;

  // Helper function to sum values for a given table and row index
  function sumCells(rowIndex, colIndex, tableStartIndex) {
    let sum = 0;
    officeKeys.forEach(office => {
      const data = officeData[office];
      if (data && data[rowIndex + tableStartIndex] && data[rowIndex + tableStartIndex][colIndex]) {
        sum += parseFloat(data[rowIndex + tableStartIndex][colIndex]) || 0;
      }
    });
    return sum;
  }

  // ===== TABLE 1: Equipment Readiness =====
  const toeTable = document.querySelectorAll("#toe-body tr");
  toeTable.forEach((row, rowIndex) => {
    const inputs = row.querySelectorAll("input");
    if (inputs.length === 2) {
      const totalA = sumCells(rowIndex, 0, 0); // Table 1 starts at index 0
      const totalB = sumCells(rowIndex, 1, 0);
      inputs[0].value = totalA;
      inputs[1].value = totalB;

      const ratingCell = row.querySelector(".rating");
      if (ratingCell) {
        let rating = totalA > 0 ? (totalB / totalA) * 100 : 0;
        rating = Math.min(rating, 100).toFixed(2);
        ratingCell.textContent = rating + "%";
      }
    }
  });

  // ===== TABLE 2: Maintenance Readiness =====
  const mrrTable = document.querySelectorAll("#mrr-body tr");
  const toeRowCount = toeRows; // offset for Table 2 in officeData
  mrrTable.forEach((row, rowIndex) => {
    const inputs = row.querySelectorAll("input");
    if (inputs.length === 2) {
      const totalA = sumCells(rowIndex, 0, toeRowCount); // Table 2 starts after Table 1
      const totalB = sumCells(rowIndex, 1, toeRowCount);
      inputs[0].value = totalA;
      inputs[1].value = totalB;

      const ratingCell = row.querySelector(".rating");
      if (ratingCell) {
        let rating = totalA > 0 ? (totalB / totalA) * 100 : 0;
        rating = Math.min(rating, 100).toFixed(2);
        ratingCell.textContent = rating + "%";
      }
    }
  });

  // Optional: trigger input events to recalc MEE/SE/final
  document.querySelectorAll("tbody").forEach(tbody => {
    tbody.dispatchEvent(new Event("input"));
  });
}

</script>
</body>
</html>
